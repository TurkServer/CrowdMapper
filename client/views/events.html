
<template name="events">
    <div id="events" class="">
    <!-- This extra container solves the problem of the absolute div clipping shit -->
    <div class="scroll-vertical" style="width: 100%; height:100%; display:block">
        <table class="table table-condensed table-hover table-striped">
            <thead>
            <tr>
                {{#each eventFields}}
                <th>
                    {{name}}
                    <span class="sorter badge badge-inverse" data-key="{{key}}">
                        <i class="icon-white {{iconClass}}"></i>
                    </span>
                </th>
                {{/each}}

                <th>Sources</th>

                <th class="header-location">Location</th>
                <th class="header-buttons"></th>
            </tr>
            </thead>
            <tbody>
            {{#each eventRecords}}
            {{> eventRow}}
            {{/each}}
            </tbody>
        </table>
    </div>
    </div>
    <a href="#" class="btn button-newevent">Create New Event</a>
</template>

<template name="eventRow">
    <tr class="{{#if editing}}info{{/if}}">

        {{#each eventFields}}
        {{eventCell ../this this}}
        {{/each}}

        <td>
            <div>
                {{#each sources}}
                {{> tweetIcon this}}
                {{/each}}
            </div>
        </td>

        <td><div>
        {{#if location}}
            <a href="#" class="action-event-mapview" title="View on map">
                {{{formatLocation}}}
            </a>
        {{else}}
            <button title="Place on map" class="btn btn-mini btn-info button-locate">
                <i class="icon-white icon-search"></i>Locate
            </button>
        {{/if}}
        </div></td>

        <td>
        {{#if editing}}
            {{#if iAmEditing}}
                <button title="Save this event" class="btn btn-mini btn-success button-save">
                    <i class="icon-white icon-ok"></i>Save
                </button>
            {{else}}
                {{> userPill editorUser}} is editing
            {{/if}}
        {{else}}
            <button title="Edit this event" class="btn btn-mini btn-warning button-edit">
                <i class="icon-white icon-pencil"></i>
            </button>
            <button title="Delete this event" class="btn btn-mini btn-danger button-delete">
                <i class="icon-white icon-trash"></i>
            </button>
        {{/if}}
        </td>
    </tr>
</template>

<template name="_eventCell">
    <td>
        <div class="{{#if editable}}editable{{/if}}">
            {{value}}
        </div>
    </td>
</template>

<template name="_eventCellSelect">
    <td><div data-type="select" data-original-title="Select {{name}}" class="{{#if editable}}editable{{/if}}">
        {{value}}
    </div></td>
</template>
